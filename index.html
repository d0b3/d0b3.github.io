<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>d0b3.github.io</title>
    <style>
      html, body { margin: 0; height: 100%; }
      body {
        display: flex;
        flex-flow: column;
        align-items: center;
        justify-content: center;
        background: #fefbf7;
        color: #a0bcc2;
      }
      textarea {
        width: 480px;
        height: 320px;
      }
    </style>
    <script type="module">

      await new Promise(r => addEventListener('DOMContentLoaded', r, { once: true }));

      const $ta = document.querySelector('textarea');
      try { $ta.value = localStorage.getItem('value') || ''; } catch { }

      const SALT = new Uint8Array([207,1,131,217,161,52,107,138,239,177,156,195,13,229,144,228,137,43,144,132,163,22,20,199,221,124,147,92,121,61,185,31,54,218,93,26,115,237,46,170,227,176,81,45,84,200,243,93,19,157,26,118,9,209,29,150,1,82,1,163,47,236,82,51]);

      const PUZZLES = [
        [ new Uint8Array([104,3,116,49,115,83,164,251,235,125,44,20,158,109,210,119,98,96,86,133,4,174,114,156,126,155,29,13,124,205,18,153,94,14,62,105,37,127,185,225,228,114,123,85,204,36,157,121,54,50,15,198,72,225,39,216,56,158,17,15,118,145,5,214,113,77,117,54,116,3,177,179,171,63,123,82,132,112,201,41,101,40,0,201,31,160,117,145,119,217,8,13,96,128,29,153,70,69,122,41,102,81,178,239,167,61,54,90,135,109,201,118,84,126,70,149,27,239,109,139,63,204,32,17,57,195,81,214,19,1,60,101,39,3,247,225,228,114,123,85,204,36,220,46,119,123,91,198,42,173,110,139,107,217,14,26,120,135,8,222,26,26,64,43,39,3,247,225,228,114,123,85,204,36,157,121,54,50,15,198,72,225,102,143,121,158,8,95,91,143,24,133,64,15,127,42,105,77,178,162,176,122,7,87,184,107,223,48,119,97,115,196,68,225,91,218,121,155,16,26,106,205,28,159,64,85,84,10,68,107,249,155,161,26,62,27,176,38,148,98,74,124,15,198,72,225,39,216,56,215,92,95,57,195,81,214,19,1,62,24]), new Uint8Array([101,183,190,228,160,144,43,95,95,255,81,17,138,157,219,1,26,115,234,170,255,210,186,141,141,163,220,124,87,221,246,96]) ],
        [ new Uint8Array([237,186,69,41,17,167,217,163,6,51,82,153,158,175,69,221,7,166,146,22,71,160,161,186,208,55,188,110,153,25,124,70,219,183,15,113,71,139,196,185,9,60,5,216,204,230,10,211,83,244,203,85,11,239,244,254,150,50,176,108,147,69,107,9,244,244,68,46,22,247,204,235,70,113,5,223,132,178,94,131,0,238,196,90,92,174,166,183,217,117,169,110,133,84,115,70,195,252,75,49,4,165,207,183,74,115,72,215,135,175,94,220,49,184,130,6,88,225,190,173,145,96,129,114,220,23,63,9,150,184,13,125,69,247,138,185,9,60,5,216,204,230,75,132,18,189,159,85,105,163,189,173,197,117,175,121,157,83,102,1,159,163,113,51,69,247,138,185,9,60,5,216,204,230,10,211,83,244,203,85,11,239,181,169,215,50,169,60,190,91,118,90,197,182,78,50,11,185,207,250,93,52,121,218,171,5,150,157,7,177,153,41,9,227,244,130,148,50,176,113,153,69,49,68,211,240,95,115,75,186,195,234,93,50,11,214,47,122,72,150,1,181,135,25,5,225,250,240,234,121,244,39,160,89,63,9,150,184,13,125,69,247,138,185,9,60,5,216,204,230,8,174]), new Uint8Array([144,8,183,131,43,234,24,47,231,24,75,206,248,193,226,198,155,114,222,252,30,119,52,155,83,24,151,183,162,52,23,123]) ],
        [ new Uint8Array([19,197,36,113,246,102,229,101,183,232,12,155,181,124,131,65,10,204,15,156,157,78,110,7,169,97,39,172,207,235,237,17,37,200,110,41,160,74,248,127,184,231,91,218,231,53,204,79,94,158,86,223,209,1,59,67,239,100,43,174,197,183,250,94,10,139,37,118,241,54,240,45,247,170,91,221,175,97,152,31,13,132,89,208,134,64,105,10,160,35,50,172,211,166,226,17,61,131,42,105,227,100,243,113,251,168,22,213,172,124,152,64,60,210,31,140,130,15,113,16,232,54,26,176,138,229,174,94,104,199,108,37,162,54,182,127,184,231,91,218,231,53,141,24,31,215,2,223,179,77,114,16,188,35,52,187,203,161,247,86,97,220,16,107,162,54,182,127,184,231,91,218,231,53,204,79,94,158,86,223,209,1,122,20,174,100,50,254,232,169,231,13,59,201,47,106,236,120,243,60,236,239,39,216,133,112,141,27,27,226,84,211,209,125,57,8,174,121,60,187,196,232,235,13,59,130,34,40,175,126,227,49,252,162,86,215,170,124,152,66,13,223,30,145,148,125,57,74,244,81,40,254,138,229,174,94,104,199,108,37,162,54,182,127,184,231,91,216,154]), new Uint8Array([6,248,0,177,60,93,98,118,125,21,76,248,195,165,7,175,104,132,143,110,26,76,185,94,198,183,210,44,12,191,81,222]) ],
        [ new Uint8Array([248,118,76,215,240,109,49,53,241,159,171,87,185,104,59,10,34,53,44,154,197,134,72,143,139,241,21,217,155,214,240,11,206,123,6,143,166,65,44,47,254,144,252,22,235,33,116,4,118,103,117,217,137,201,29,203,205,244,25,219,145,138,231,68,225,56,77,208,247,61,36,125,177,221,252,17,163,117,32,84,37,125,122,214,222,136,79,130,130,179,0,217,135,155,255,11,214,48,66,207,229,111,39,33,189,223,177,25,160,104,32,11,20,43,60,138,218,199,87,152,202,166,40,197,222,216,179,68,131,116,4,131,164,61,98,47,254,144,252,22,235,33,53,83,55,46,33,217,235,133,84,152,158,179,6,206,159,156,234,76,138,111,120,205,164,61,98,47,254,144,252,22,235,33,116,4,118,103,117,217,137,201,92,156,140,244,0,139,188,148,250,23,208,122,71,204,234,115,39,108,170,152,128,20,143,96,58,77,51,43,52,165,139,197,29,183,207,247,27,202,150,214,189,74,141,32,75,207,232,120,108,33,240,192,189,69,184,118,151,146,36,51,48,139,135,199,254,87,143,248,6,202,146,148,189,56,129,125,31,255,234,61,98,47,254,144,252,22,235,33,116,4,118,103,117,217,137,203,96]), new Uint8Array([216,0,225,135,141,177,194,114,177,77,129,147,42,179,204,136,128,19,62,167,91,242,93,17,10,0,5,181,100,173,244,25]) ]
      ];

      $ta.onchange = $ta.onkeyup = async () => {
        const secret = new Uint8Array(await crypto.subtle.digest('SHA-256', new TextEncoder().encode($ta.value)));
        for (const [ schatz, verify ] of PUZZLES) {
          for (let i = 0; i < schatz.length; i++) schatz[i] ^= secret[i%secret.length];
          const buf = new Uint8Array(SALT.length + schatz.length + SALT.length);
          buf.set(SALT, 0);
          buf.set(schatz, SALT.length);
          buf.set(SALT, SALT.length + schatz.length);
          const solved = new Uint8Array(await crypto.subtle.digest('SHA-256', buf));
          let equal = true;
          for (let i = 0; i < solved.length && equal; i++) equal = solved[i] === verify[i];
          if (equal) {
            try { localStorage.setItem('value', $ta.value); } catch { }
            $ta.onchange = $ta.onkeyup = null;
            $ta.value = 'checking';
            const [ url, user, pass ] = JSON.parse(new TextDecoder().decode(schatz));
            try {
              const res = await fetch(url);
              if (!res.ok) throw 'nope';
            } catch {
              $ta.value = 'vodafone mÃ¼de';
              setTimeout(() => { location.reload(); }, 10000);
              return;
            }
            document.querySelector('style').remove();
            document.querySelector('body').innerHTML = '';
            document.querySelector('script').textContent = code;
            return;
          }
          for (let i = 0; i < schatz.length; i++) schatz[i] ^= secret[i%secret.length];
        }

      };

      $ta.onchange();

    </script>
  </head>
  <body>
    <h1>hello world</h1>
    <textarea></textarea>
  </body>
</html>