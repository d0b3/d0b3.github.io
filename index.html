<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<title>d0b3.github.io</title>
		<style>
			html, body { margin: 0; height: 100%; }
			body {
				display: flex;
				flex-flow: column;
				align-items: center;
				justify-content: center;
				background: #fefbf7;
				color: #a0bcc2;
			}
			textarea {
				width: 480px;
				height: 320px;
			}
		</style>
		<script type="module">
	
			const PUZZLE = new Uint8Array([114,58,228,221,232,108,230,138,85,176,18,158,165,163,153,65,28,1,117,63,190,201,197,99,201,250,137,119,67,245,159,178,19,82,250,100,11,148,62,170,184,112,31,201,219,165,120,241,229,199,120,30,127,203,178,137,11,55,23,146,8,2,74,139,117,54,241,221,235]);
		
			await new Promise(r => onload = r);

			const $ta = document.querySelector('textarea');
			try { $ta.value = localStorage.getItem('value') || ''; } catch { }

			$ta.onchange = $ta.onkeyup = async () => {
				const hash = new Uint8Array(await crypto.subtle.digest('SHA-512', new TextEncoder().encode($ta.value)));
				for (let i = 0; i < PUZZLE.length; i++) PUZZLE[i] ^= hash[i%hash.length];
				const value = new TextDecoder().decode(PUZZLE);
				for (let i = 0; i < PUZZLE.length; i++) PUZZLE[i] ^= hash[i%hash.length];
				if (value.startsWith('http')) {
					try { localStorage.setItem('value', $ta.value); } catch { }
					location.href = value;
				}
			};

			$ta.onchange();

		</script>
	</head>
	<body>
		<h1>danifragen</h1>
		<textarea></textarea>
	</body>
</html>
