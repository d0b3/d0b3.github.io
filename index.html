<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>d0b3.github.io</title>
    <style>
      html, body { margin: 0; height: 100%; }
      body {
        display: flex;
        flex-flow: column;
        align-items: center;
        justify-content: center;
        background: #fefbf7;
        color: #a0bcc2;
      }
      textarea {
        width: 480px;
        height: 320px;
      }
    </style>
    <script type="module">

      await new Promise(r => addEventListener('DOMContentLoaded', r, { once: true }));

      const $ta = document.querySelector('textarea');
      try { $ta.value = localStorage.getItem('value') || ''; } catch { }

      const SALT = new Uint8Array([138,205,69,96,83,127,38,174,33,201,191,163,174,5,122,246,242,228,129,159,82,127,39,16,150,10,208,221,4,201,16,197,247,165,11,122,76,5,42,175,172,209,137,53,176,46,149,221,89,100,159,116,140,3,127,52,67,100,146,6,29,175,108,15]);

      const PUZZLES = [
        [ new Uint8Array([237,186,69,41,17,167,217,163,6,51,74,156,136,181,7,128,22,183,153,16,95,174,166,167,155,56,178,114,150,66,113,74,194,241,66,51,72,163,195,235,76,50,81,138,149,165,70,156,6,176,141,25,74,189,177,240,213,52,176,51,222,27,61,117,216,184,13,125,69,247,138,185,9,60,5,216,204,230,10,211,83,244,203,28,70,191,187,172,194,123,159,112,149,68,108,9,208,234,66,48,69,240,194,237,93,108,86,194,195,233,69,151,23,167,198,6,78,172,166,187,194,58,175,101,209,84,112,71,220,237,67,62,17,190,197,247,4,104,76,138,137,232,94,129,10,183,135,26,94,171,178,178,215,41,184,50,159,88,114,6,221,241,89,114,39,187,195,234,90,50,79,139,203,253,118,157,83,244,203,85,11,239,244,254,150,123,253,60,220,23,63,9,150,184,76,42,4,190,222,185,107,112,76,139,159,232,88,150,18,176,146,93,2,244,136,176,150,123,253,60,220,23,63,9,150,184,13,125,69,247,138,185,9,60,68,143,141,175,94,211,49,184,130,6,88,225,183,177,216,53,184,127,136,31,67,11,241,91,145,51,17,178,216,197,11,48,5,164,206,175,71,158,22,166,197,24,78,167,166,240,152,54,180,111,136,25,49,7,117,36,79,56,23,182,198,245,7,50,11,214,176,228,3,200,47,186,203,85,11,239,244,254,150,123,253,60,220,23,63,9,150,184,15,0]), new Uint8Array([167,53,161,232,155,41,78,0,127,199,165,134,237,92,232,177,73,86,101,1,53,20,218,33,172,147,148,248,85,124,155,96]) ]
      ];

      $ta.onchange = $ta.onkeyup = async () => {
        const secret = new Uint8Array(await crypto.subtle.digest('SHA-256', new TextEncoder().encode($ta.value)));
        for (const [ schatz, verify ] of PUZZLES) {
          for (let i = 0; i < schatz.length; i++) schatz[i] ^= secret[i%secret.length];
          const buf = new Uint8Array(SALT.length + schatz.length + SALT.length);
          buf.set(SALT, 0);
          buf.set(schatz, SALT.length);
          buf.set(SALT, SALT.length + schatz.length);
          const solved = new Uint8Array(await crypto.subtle.digest('SHA-256', buf));
          let equal = true;
          for (let i = 0; i < solved.length && equal; i++) equal = solved[i] === verify[i];
          if (equal) {
            try { localStorage.setItem('value', $ta.value); } catch { }
            $ta.onchange = $ta.onkeyup = null;
            $ta.value = 'checking';
            const [ url, code ] = JSON.parse(new TextDecoder().decode(schatz));
            try {
              const res = await fetch(url);
              if (!res.ok) throw 'nope';
            } catch {
              $ta.value = 'vodafone mÃ¼de';
              setTimeout(() => { location.reload(); }, 10000);
              return;
            }
            document.querySelector('style').remove();
            document.querySelector('body').innerHTML = '';
            document.querySelector('script').textContent = code;
            return;
          }
          for (let i = 0; i < schatz.length; i++) schatz[i] ^= secret[i%secret.length];
        }

      };

      $ta.onchange();

    </script>
  </head>
  <body>
    <h1>hello world</h1>
    <textarea></textarea>
  </body>
</html>