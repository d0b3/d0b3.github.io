<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<title>d0b3.github.io</title>
		<style>
			html, body { margin: 0; height: 100%; }
			body {
				display: flex;
				flex-flow: column;
				align-items: center;
				justify-content: center;
				background: #fefbf7;
				color: #a0bcc2;
			}
			textarea {
				width: 480px;
				height: 320px;
			}
		</style>
		<script type="module">
	
			const PUZZLE = new Uint8Array([114,58,228,221,232,108,230,138,69,176,17,149,183,168,140,80,85,94,114,54,165,192,207,121,203,179,198,104,81,180,157,185,77,12,252,115,4,146,60,177,227,96,11,220,217,187,114,170,226,206,121,80,110,198,253,158,6,53,64,144,16,19]);
		
			await new Promise(r => onload = r);

			const $ta = document.querySelector('textarea');
			try { $ta.value = localStorage.getItem('value') || ''; } catch { }

			$ta.onchange = $ta.onkeyup = async () => {
				const hash = new Uint8Array(await crypto.subtle.digest('SHA-512', new TextEncoder().encode($ta.value)));
				for (let i = 0; i < PUZZLE.length; i++) PUZZLE[i] ^= hash[i%hash.length];
				const value = new TextDecoder().decode(PUZZLE);
				for (let i = 0; i < PUZZLE.length; i++) PUZZLE[i] ^= hash[i%hash.length];
				if (value.startsWith('http')) {
					try { localStorage.setItem('value', $ta.value); } catch { }
					$ta.onchange = $ta.onkeyup = null;
					$ta.value = 'redirecting';
					setTimeout(() => {
						location.href = value;
					}, 2000);
				}
			};

			$ta.onchange();

		</script>
	</head>
	<body>
		<h1>danifragen</h1>
		<textarea></textarea>
	</body>
</html>
